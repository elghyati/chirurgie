{% extends 'base.html.twig' %}

{% block title %}Fiche Article{% endblock %}

{% block body %}
    <!-- Start All Title Box -->
    <div class="all-title-box">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h2>Fiche article</h2>
                    <ul class="breadcrumb">
                        <li class="breadcrumb-item"><a href="{{ path('article_shop')}}">{{(app.user) ? 'Boutique' : 'Demande de prix'}} </a></li>
                        <li class="breadcrumb-item active">Fiche article</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- End All Title Box -->

    <!-- Start Shop Detail  -->
    <div class="shop-detail-box-main">
        <div class="container">
            <div id="product" class="row">
                <div class="col-xl-5 col-lg-5 col-md-6">
                    <div id="carousel-images" class="single-product-slider carousel slide" data-ride="carousel">
                        <div class="carousel-inner" role="listbox">
                            <div class="carousel-item active"> <img class="d-block w-100" src="{{ asset('uploads/images/articles/' ~ article.coverImage) }}" alt="Cover Image"> </div>
                                {% for image in article.images %}
                                <div class="carousel-item"> <img class="d-block w-100" src="{{ asset('uploads/images/articles/' ~  image.url) }}" alt=" image.caption"> </div>
                                {% endfor %}
                        </div>

                        <a class="carousel-control-prev" href="#carousel-images" role="button" data-slide="prev"> 
                            <i class="fa fa-angle-left" aria-hidden="true"></i>
                            <span class="sr-only">Previous</span> 
                        </a>
                        <a class="carousel-control-next" href="#carousel-images" role="button" data-slide="next"> 
                            <i class="fa fa-angle-right" aria-hidden="true"></i> 
                            <span class="sr-only">Next</span> 
                        </a>

                        <ol class="carousel-indicators">
                            <li data-target="#carousel-images" data-slide-to="0" class="active">
                                <img class="d-block w-100 img-fluid" src="{{ asset('uploads/images/articles/' ~ article.coverImage) }}" alt="" />
                            </li>
                            {% for image in article.images %}
                                <li data-target="#carousel-images" data-slide-to="{{ loop.index }}">
                                    <img class="d-block w-100 img-fluid" src="{{ asset('uploads/images/articles/' ~ image.url) }}" alt="" />
                                </li>
                            {% endfor %}
                        </ol>
                    </div>
                </div>
                <div class="col-xl-7 col-lg-7 col-md-6">
                    {# <div class="single-product-details">
                        <h2>{{ article.designation}}</h2>
                        {# {% if app.user %} #}
                            {# <h5> <del>{{ (article.price * 1.2) | number_format(2, ',', ' ') }}</del> {{ article.price |number_format(2, ',', ' ') }} DH</h5> #}
                        {# {% endif %} #}

                        {#                        <p class="available-stock"><span> More than 20 available / <a href="#">8 sold </a></span><p>#}
                        {# <h4>Déscription:</h4>
                        <div class="single-product-description">
                            {{ article.description|raw}}
                        </div>

                        <h4>Tailles :</h4>
                        {% if article.sizes|length >0%}
                            <div style="margin-left: 20px">
                                {% for size in article.sizes %}
                                    <div class="d-inline p-2 bg-primary text-white">{{ size.size }}</div>
                                    {#                                <h5>{{ size.size }}</h5>#}
                                {# {% endfor %}
                            </div>
                        {% else %}
                            <div style="margin-left: 20px"><h5>Taille standard</h5></div>
                        {% endif %} #}
                        {#<p>Nam sagittis a augue eget scelerisque. Nullam lacinia consectetur sagittis. Nam sed neque id eros fermentum dignissim quis at tortor. Nullam ultricies urna quis sem sagittis pharetra. Nam erat turpis, cursus in ipsum at,
                            tempor imperdiet metus. In interdum id nulla tristique accumsan. Ut semper in quam nec pretium. Donec egestas finibus suscipit. Curabitur tincidunt convallis arcu. </p>#}
                        {# {% if app.user %} #}
                            {# <ul>
                                <li>
                                    <div class="form-group quantity-box">
                                        <label class="control-label">Quantité</label>
                                        {#                                    <input class="form-control" value="1" min="1" max="100" type="number">#}
                                        {# <input id="quantity" name="quantity" class="form-control" value="1" min="1" type="number">
                                    </div>
                                </li>
                            </ul> #}
                        {# {% endif %} #}


                        {# <div class="price-box-bar">
                            <div class="cart-and-bay-btn"> #}
                                {#                                <a class="btn hvr-hover" data-fancybox-close="" href="#">Buy New</a>#}
                                {# <a id="add_to_cart" class="btn hvr-hover text-white mt-5" data-fancybox-close="" data-path="{{ path('cart_add',{'id':article.id}) }}">Ajouter au panier</a>
                            </div>
                        </div>

                        <div class="add-to-btn">
                            <div class="add-comp"> #}
                                {#<a class="btn hvr-hover" href="#"><i class="fas fa-heart"></i> Add to wishlist</a>
                                <a class="btn hvr-hover" href="#"><i class="fas fa-sync-alt"></i> Add to Comparer</a>#}
                            {# </div>
                            <div class="share-bar">
                                <a class="btn hvr-hover" href="#"><i class="fab fa-facebook" aria-hidden="true"></i></a>
                                <a class="btn hvr-hover" href="#"><i class="fab fa-google-plus" aria-hidden="true"></i></a>
                                <a class="btn hvr-hover" href="#"><i class="fab fa-twitter" aria-hidden="true"></i></a>
                                <a class="btn hvr-hover" href="#"><i class="fab fa-pinterest-p" aria-hidden="true"></i></a>
                                <a class="btn hvr-hover" href="#"><i class="fab fa-whatsapp" aria-hidden="true"></i></a>
                            </div>
                        </div>
                    </div>  #}

                            <div class="pb-right-column">
                                <h1 class="product-name">{{ article.designation}}</h1>
                                <div class="product-comments">
                                    {# <div class="product-star">
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star-half-o"></i>
                                    </div> #}
                                    {% if article.sizes|length >0%}
                                    <div class="comments-advices">
                                        {% for size in article.sizes %}
                                        {# <a href="#">Based  on 3 ratings {{ size.size }}</a>
                                        <a href="#"><i class="fa fa-pencil"></i> write a review</a> #}
                                        {% endfor %}
                                    </div>
                                    {% else %}
                                    <div style="margin-left: 20px"><h5>Taille standard</h5></div>
                                    {% endif %}
                                </div>
                                <div class="product-price-group">
                                    <span class="price">{{ article.price |number_format(2, ',', ' ') }} DH</span>
                                    <span class="old-price"><del>{{ (article.price * 1.2) | number_format(2, ',', ' ') }}</del></span>
                                    <span class="discount">-30%</span>
                                </div>
                                <div class="info-orther">
                                    {# <p>Item Code: #453217907</p> #}
                                    <p>Disponibilité: <span class="in-stock">Dans le stock</span></p>
                                    {# <p>Condition: New</p> #}
                                </div>
                                <div class="product-desc">
                                    {{ article.description|raw}}.
                                </div>
                                <div class="form-option">
                                    <p class="form-option-title">Options:</p>
                                    <div class="attributes">
                                        <div class="attribute-label">Couleur:</div>
                                        <div class="m-l20 attribute-list">
                                            <ul class="list-color">
                                                <li style="background:#0c3b90;"><a href="#">red</a></li>
                                                <li style="background:#036c5d;" class="active"><a href="#">red</a></li>
                                                <li style="background:#5f2363;"><a href="#">red</a></li>
                                                <li style="background:#ffc000;"><a href="#">red</a></li>
                                                <li style="background:#36a93c;"><a href="#">red</a></li>
                                                <li style="background:#ff0000;"><a href="#">red</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="attributes">
                                        <div class="attribute-label">Quantité:</div>
                                        <div class="attribute-list product-qty">
                                            <div class="qty">
                                                <input id="option-product-qty" type="text" value="1">
                                            </div>
                                            <div class="btn-plus">
                                                <a href="#" class="btn-plus-up">
                                                    <i class="fa fa-caret-up"></i>
                                                </a>
                                                <a href="#" class="btn-plus-down">
                                                    <i class="fa fa-caret-down"></i>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="attributes">
                                        <div class="attribute-label">Size:</div>
                                        <div class="m-l20 attribute-list">
                                            <select>
                                                <option value="1">X</option>
                                                <option value="2">XL</option>
                                                <option value="3">XXL</option>
                                            </select>
                                            {# <a id="size_chart" class="fancybox" href="assets/data/size-chart.jpg">Size Chart</a> #}
                                        </div>
                                        
                                    </div>
                                </div>
                                <div class="form-action">
                                    <div class="button-group">
                                        <a style="color:white" class="btn hvr-hover"  data-path="{{ path('cart_add',{'id':article.id}) }}">Ajouter au panier</a>
                                    </div>
                                </div>
                            </div>
                </div>
            </div>

        </div>
    </div>
    <!-- End Cart -->
{% endblock %}

{% block javascripts %}
    <script>
        function onAddArticle(event) {
            event.preventDefault();
            console.log("#add_to_cart is clicked");
            var $url = $(this).attr("data-path");
            var $qte = $("#quantity").val();
            console.log($qte);
            $.ajax({
                type: "POST",
                url: $url,
                data: {quantity: $qte},
                success: function (data) {
                    CartPreview(data);
                }
            });

        }
        $(document).ready(function () {

            document.querySelectorAll('#add_to_cart').forEach(function (link) {
                link.addEventListener('click', onAddArticle);
            });

        });
    </script>
{% endblock %}